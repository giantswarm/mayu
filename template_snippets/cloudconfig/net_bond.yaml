{{define "net_bond"}}
  - name: 10-bond0-slave.network
    runtime: true
    content: |
      [Match]
      Name=en*

      [Network]
      Bond=bond0

  - name: 20-bond0.network
    runtime: true
    content: |
      [Match]
      Name=bond0

      [Network]
      DHCP=none
      VLAN=bond0.1
      VLAN=bond0.27

  - name: 15-bond0.netdev
    runtime: true
    content: |
      [NetDev]
      Name=bond0
      Kind=bond

      [Bond]
      Mode=802.3ad
      LACPTransmitRate=fast
      MIIMonitorSec=1s
      UpDelaySec=3s
      DownDelaySec=9s

  - name: 35-bond0.1.netdev
    runtime: true
    content: |
      [NetDev]
      Name=bond0.1
      Kind=vlan

      [VLAN]
      Id=1

  - name: 35-bond0.27.netdev
    runtime: true
    content: |
      [NetDev]
      Name=bond0.27
      Kind=vlan

      [VLAN]
      Id=27

  - name: 40-vlan.network
    runtime: true
    content: |
      [Match]
      Name=bond0.27

      [Network]
      Address={{.Host.InternalAddr}}/24
      Gateway=10.0.1.254
      {{ range $server := .ClusterNetwork.DNS }}DNS={{ $server }}
      {{ end }}
      {{ range $server := .ClusterNetwork.NTP }}NTP={{ $server }}
      {{ end }}

{{end}}
